<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Catch the Coin</title>
  <style>
    * { box-sizing: border-box; }
    body {
      margin: 0;
      background: #111;
      color: white;
      font-family: Arial, sans-serif;
      text-align: center;
    }
    canvas {
      background: #333;
      display: block;
      margin: 0 auto;
    }
    #scoreBoard {
      margin-top: 10px;
      font-size: 20px;
    }
    #startBtn {
      margin-top: 15px;
      padding: 10px 20px;
      font-size: 18px;
      cursor: pointer;
      background: gold;
      border: none;
      border-radius: 5px;
    }

    #coin{
      margin-right: 10px;
      margin-top: 5px;
      height: 40px;
      width: 50px;
    }
    
  </style>
</head>
<body>

<h1><img id="coin" src="img/coin.png" alt="coin">Coin Catcher</h1>
<canvas id="gameCanvas" width="800" height="500"></canvas>
<div id="scoreBoard">P1: 0 | P2: 0</div>
<button id="startBtn">Start Game</button>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");
const startBtn = document.getElementById("startBtn");

let gameRunning = false;

const player1 = {
  x: 200,
  y: 460,
  width: 60,
  height: 20,
  color: "black",
  score: 0,
  leftKey: "KeyA",
  rightKey: "KeyD"
};

const player2 = {
  x: 500,
  y: 460,
  width: 60,
  height: 20,
  color: "white",
  score: 0,
  leftKey: "ArrowLeft",
  rightKey: "ArrowRight"
};

let coins = [];
const coinCount = 5; 

const keys = {};

document.addEventListener("keydown", (e) => {
  keys[e.code] = true;

  if (e.code === "KeyR") {
    resetGame();
    gameRunning = true;
  }
});
document.addEventListener("keyup", (e) => {
  keys[e.code] = false;
});

startBtn.addEventListener("click", () => {
  resetGame();
  gameRunning = true;
});

function createCoins() {
  coins = [];
  for (let i = 0; i < coinCount; i++) {
    coins.push({
      x: Math.random() * 740 + 30,
      y: Math.random() * -500, // spawn above screen
      radius: 15,
      color: "gold",
      speed: 2 + Math.random() * 2
    });
  }
}

function movePlayers() {
  if (keys[player1.leftKey]) player1.x -= 5;
  if (keys[player1.rightKey]) player1.x += 5;
  if (keys[player2.leftKey]) player2.x -= 5;
  if (keys[player2.rightKey]) player2.x += 5;

  player1.x = Math.max(0, Math.min(canvas.width - player1.width, player1.x));
  player2.x = Math.max(0, Math.min(canvas.width - player2.width, player2.x));
}

function updateCoins() {
  for (let coin of coins) {
    coin.y += coin.speed;

    // Player 1 catches coin
    if (
      coin.y + coin.radius >= player1.y &&
      coin.x > player1.x &&
      coin.x < player1.x + player1.width
    ) {
      player1.score++;
      resetCoin(coin);
    }

    // Player 2 catches coin
    if (
      coin.y + coin.radius >= player2.y &&
      coin.x > player2.x &&
      coin.x < player2.x + player2.width
    ) {
      player2.score++;
      resetCoin(coin);
    }

    // Missed coin
    if (coin.y > canvas.height) {
      resetCoin(coin);
    }
  }
}

function resetCoin(coin) {
  coin.x = Math.random() * 740 + 30;
  coin.y = Math.random() * -200;
  coin.speed = 2 + Math.random() * 2;
}

function drawPlayer(player) {
  ctx.fillStyle = player.color;
  ctx.fillRect(player.x, player.y, player.width, player.height);
}

function drawCoins() {
  for (let coin of coins) {
    ctx.beginPath();
    ctx.arc(coin.x, coin.y, coin.radius, 0, Math.PI * 2);
    ctx.fillStyle = coin.color;
    ctx.fill();
    ctx.closePath();
  }
}

function updateScoreBoard() {
  document.getElementById("scoreBoard").textContent =
    `P1: ${player1.score} | P2: ${player2.score}`;
}

function checkWin() {
  if (player1.score >= 10) {
    gameRunning = false;
    alert("Player 1 Wins! HEHE");
  }
  if (player2.score >= 10) {
    gameRunning = false;
    alert("Player 2 Wins! HEHE");
  }
}

function draw() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  drawPlayer(player1);
  drawPlayer(player2);
  drawCoins();
}

function gameLoop() {
  if (gameRunning) {
    movePlayers();
    updateCoins();
    draw();
    updateScoreBoard();
    checkWin();
  }
  requestAnimationFrame(gameLoop);
}

function resetGame() {
  player1.score = 0;
  player2.score = 0;
  player1.x = 200;
  player2.x = 500;
  createCoins();
  updateScoreBoard();
}

createCoins();
gameLoop();
</script>

</body>
</html>
